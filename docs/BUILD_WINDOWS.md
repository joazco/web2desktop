# Build Windows

This document explains how building a Windows executable and installer works.

## Makers

### Zip

By default on Windows, `npm run make` generates a `.zip` file in `out/make` containing everything needed to run your app’s `.exe`.

### WiX (recommanded)

You can refer to the [WiX documentation](https://www.electronforge.io/config/makers/wix-msi).

WiX is a Windows packaging solution that creates fully customizable MSI installers for Electron apps.

It provides advanced control over the install process (directory, options, components, system integration) but requires external tools.

Prerequisites:

- Download WiX Tools: https://github.com/wixtoolset/wix3/releases
- Add to [your PATH environment variable](https://www.architectryan.com/2018/03/17/add-to-the-path-on-windows-10/): `C:\Program Files (x86)\WiX Toolset v3.14\bin`

### Squirrel.Windows

You can refer to the [Squirrel.Windows documentation](https://www.electronforge.io/config/makers/squirrel.windows).

Squirrel is a packaging solution for Electron that requires no external tools for end users, but it automatically installs the app in the user's AppData folder.

It offers a simple, transparent install but has limitations, including no installer customization and no choice of install directory.

### MSIX (recommanded if you signin app)

You can refer to the [MSIX documentation](https://www.electronforge.io/config/makers/msix).

MSIX distributes Windows apps with a modern, secure format and a sandboxed, standardized installation, at the cost of stronger constraints and reduced flexibility.

**MSIX requires signing both the app and installer to allow installation on Windows. Without a valid signature, installation is blocked or requires advanced user steps.**

Prerequisites:

- Download the Windows SDK: https://learn.microsoft.com/windows/apps/windows-sdk/downloads

#### Activation

To create an installer, Web2Desktop provides the Squirrel.Windows maker, which **must be enabled** in [src/config.ts](../src/config.ts).

```typescript
/**
 * web2desktop
 * https://github.com/joazco/web2desktop
 * © 2026 Jordan Azoulay — MIT License
 */

import { AppConfigInterface } from "./types";

const config: Omit<AppConfigInterface, "size"> = {
    .....,
    build: {
        ....,
        windows: {
            makers: ["wix", "squirrel", "msix"],
        }
    }
}
```

#### Signing

**Windows code signing is complex and expensive. The configuration below is theoretical and based on the official documentation.**

You can refer to the [Electron documentation](https://www.electronjs.org/docs/latest/tutorial/code-signing).

To sign your application, add your certificate in [src/config.ts](../src/config.ts).

```typescript
/**
 * web2desktop
 * https://github.com/joazco/web2desktop
 * © 2026 Jordan Azoulay — MIT License
 */

import { AppConfigInterface } from "./types";

const config: Omit<AppConfigInterface, "size"> = {
    .....,
    build: {
        ....,
        windows: {
            makers: ["wix", "squirrel", "msix"],
            signature: {
                certificateFile: string // Path to certificate
                certificatePassword: string
            }
        }
    }
}
```

## Inno Setup (advanced)

[**Inno Setup**](https://jrsoftware.org/ishelp/index.php?topic=filessection) is a powerful **Windows** installer builder widely used
to distribute software through customized installers.

It relies on a **Pascal**-based scripting language (Pascal Script), which lets you
precisely control the installation flow (screens, options, files, shortcuts, registry, etc.).

### Strengths

- Highly customizable Windows installers
- Choice of install directory
- Ability to create custom wizards
- No external dependencies for end users
- Mature and widely used tool

### Weaknesses

- Requires a dedicated scripting language (Pascal Script)
- More complex to configure and maintain
- Not designed for modern Electron workflows

### Using it with Web2Desktop

Inno Setup is **not directly integrated** with Web2Desktop.

To use it with a Web2Desktop project, you need to:

- install and use [Inno Setup](https://jrsoftware.org/isdl.php)
- create an Inno Setup script for your Web2Desktop project
- manually package from the files generated by Web2Desktop

This approach can fit very specific installation needs,
but it involves a more complex and less automated workflow. It is still recommended,
because once mastered, Inno Setup can produce a very professional installer.
